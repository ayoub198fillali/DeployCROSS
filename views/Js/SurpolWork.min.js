debugCharge&&console.log("(Work)SurpolWork charged!");let tableDestNavireSurpol,tableDestEventsSurpol,IEQofficierDePermananceSurpol,IEQchefDeQuartSurpol,IEQadjointDeQuartSurpol,LISTpavillonSurpol;function ConfigUpdateAllListsSurpol(){$.ajax({type:"GET",dataType:"text",url:"views/Php/Surnav/GETAllLists.php",success:function(e){let t=e.split(";!;");IEQofficierDePermananceSurpol=t[0].split(","),IEQchefDeQuartSurpol=t[1].split(","),IEQadjointDeQuartSurpol=t[2].split(","),LISTpavillonSurpol=t[3].split(",")}})}function AllConfigInputSurpol(){ConfigIEQofficierDePermananceSurpol(),ConfigIEQchefDeQuartSurpol(),ConfigIEQadjointDeQuartSurpol(),ConfigLISTpavillonSurpol()}function ConfigIEQofficierDePermananceSurpol(){let t;$("#IEQofficierDePermananceSurpol").each(function(){t="";for(const e of IEQofficierDePermananceSurpol)t+=`<option>${e}</option>`;$(this).empty().append(t),sortSelect($(this)[0].id)})}function ConfigIEQchefDeQuartSurpol(){let t;$("#IEQchefDeQuartSurpol").each(function(){t="";for(const e of IEQchefDeQuartSurpol)t+=`<option>${e}</option>`;$(this).empty().append(t),sortSelect($(this)[0].id)})}function ConfigIEQadjointDeQuartSurpol(){let t;$("#IEQadjointDeQuartSurpol").each(function(){t="";for(const e of IEQadjointDeQuartSurpol)t+=`<option>${e}</option>`;$(this).empty().append(t),sortSelect($(this)[0].id)})}function ConfigLISTpavillonSurpol(){let t;$("#NAVIREpavillonSurpol").each(function(){t="";for(const e of LISTpavillonSurpol)t+=`<option>${e}</option>`;$(this).empty().append(t),sortSelect($(this)[0].id)})}function ConfigSurpol(e=!1){debug&&console.log("*** ConfigSurpol =>"+e),e?AllConfigInputSurpol():(ConfigUpdateAllListsSurpol(),Swal.fire({title:"Update Data From Server !",html:"A Few Milliseconds Please.",timer:600,timerProgressBar:!0,didOpen:()=>{Swal.showLoading()}}).then(()=>{AllConfigInputSurpol(),UpdateSurpolForm(),setTimeout(()=>{configTypeEventSurpol()},500)})),setTimeout(()=>{0==$("#IEQofficierDePermananceSurpol option").length&&ConfigSurpol(!0)},500)}function SetPropsSurpol(){showHideSurpol(),GETNavireSurpol(),ConfigSurpol(),setThisDateSurpol(),setThisDateSurpolUpdate(),autoCompleteSurpol(),resetSurpolFormTop(),gotoMapSurpol(),GetLastIdSurpol(),GETEventsSurpol(),addListnerToDetectChangesInFormSurpol(),addListnerForEventTableSurpol(),addListnerForStringSelectToTextAreaSurpol()}function setThisDateSurpol(){$("#INFOquartDeSurpol")[0].selectedIndex=parseInt((new Date).toISOString().split("T")[1].split(".")[0].split(":",1))/4,$("#IEQleSurpol").val((new Date).toISOString().split("T")[0]),$("#INFOduSurpol").val((new Date).toISOString().split("T")[0]),$("#INFOaUTCSurpol,#OBSaUTCSurpol").val((new Date).toISOString().split("T")[1].split(".")[0].split(":",2).join(":"))}function setThisDateSurpolUpdate(){$("#CHRONOheureUTCSurpol").off("dblclick").on("dblclick",function(){$("#CHRONOheureUTCSurpol").val((new Date).toISOString().split("T")[1].split(".")[0].split(":",2).join(":"))}),$("#CHRONOdateSurpol").off("dblclick").on("dblclick",function(){$("#CHRONOdateSurpol").val((new Date).toISOString().split("T")[0])}),$("#CHRONOheureUTCSurpol").val((new Date).toISOString().split("T")[1].split(".")[0].split(":",2).join(":")),$("#CHRONOdateSurpol").val((new Date).toISOString().split("T")[0])}function GetLastIdSurpol(){if(!window.sessionStorage.updateSurpolForm){const e=new XMLHttpRequest;e.onload=function(){var e=this.responseText.split("/")[0],t=this.responseText.split("/")[1],e=(+e+1).toString().padStart(5,"0");debug&&console.log("Last Id  "+e),$("#idSurpol")[0].innerHTML=e,$("#idSurpol")[0].setAttribute("trueid",+t+1)},e.open("GET","views/Php/Surpol/SurpolGetLastId.php?thisdate="+(new Date).toISOString().split("-")[0]),e.send()}}function autoCompleteSurpol(){$("#TOLpositionN1Surpol ,#TOLpositionN2Surpol , #TOLpositionE1Surpol, #TOLpositionE2Surpol").off("keyup").on("keyup",function(e){let t=this.value,o=0;"TOLpositionE1Surpol"!=this.id&&"TOLpositionE2Surpol"!=this.id||(o=1),"Backspace"!=e.key||t.length!==2+o&&t.length!==5+o&&t.length!==8+o?"Backspace"!=e.key||t.length!==30+o&&t.length!==15+o?(t.length===2+o&&(this.value=t+"°"),t.length===5+o&&(this.value=t+","),t.length===8+o&&(this.value=t+"'")):this.value=t.split("").slice(0,-14).join(""):this.value=t.split("").slice(0,-1).join("")}),$("#TOLazimut1Surpol, #TOLazimut2Surpol").off("keyup").on("keyup",function(e){let t=this.value;"Backspace"==e.key&&3===t.length?this.value=t.split("").slice(0,-1).join(""):3===t.length&&(this.value=t+"°")}),$("#NAVIRERteVitSurpol").off("keyup").on("keyup",function(e){let t=this.value;"Backspace"==e.key&&4===t.length?this.value=t.split("").slice(0,-2).join(""):3===t.length&&(this.value=t+"°/")})}function GETNavireSurpol(e=!0){const t=new XMLHttpRequest;t.onload=function(){debugUpdates&&console.log("GETNavireSurpol onload"),e||tableDestNavireSurpol.destroy(),$("#navireTable").html(this.responseText),tableDestNavireSurpol=$("#NAVIRETableSurpol").DataTable({dom:"lfrtip",language:{info:"Affichage de la page _PAGE_ sur _PAGES_",infoFiltered:"(filtrée de _MAX_ entrée)",lengthMenu:"Affichage de _MENU_ entrées",searchPlaceholder:"Chercher:  ",emptyTable:" "},oSearch:{sSearch:"#xxxxxxxxxx#"},ordering:!0,info:!0,autoFill:!0,responsive:!0}),$("#NAVIRETableSurpol").off("search.dt").on("search.dt",function(){setTimeout(function(){""==tableDestNavireSurpol.search().trim()?$("#navireTable tr").each(function(){$(this).addClass("hidden")}):$("#navireTable tr").each(function(){$(this).removeClass("hidden")})},10)}),$("input[aria-controls=NAVIRETableSurpol]").val(""),tableDestNavireSurpol.search("")},t.open("GET","views/Php/Surpol/GETNavires.php"),t.send()}function copyDataNavireSurpol(){var e=this.id;$("#NAVIREnomSurpol").val($(`#${e} :nth-child(1)`)[0].innerText),$("#NAVIREtypeSurpol").val($(`#${e} :nth-child(2)`)[0].innerText),$("#NAVIREpavillonSurpol").val($(`#${e} :nth-child(3)`)[0].innerText),$("#NAVIRECSSurpol").val($(`#${e} :nth-child(4)`)[0].innerText),$("#NAVIREMMSISurpol").val($(`#${e} :nth-child(5)`)[0].innerText),$("#NAVIREOMISurpol").val($(`#${e} :nth-child(6)`)[0].innerText),$("#NAVIRElongueurSurpol").val($(`#${e} :nth-child(7)`)[0].innerText),$("#NAVIREjaugeBrutSurpol").val($(`#${e} :nth-child(8)`)[0].innerText),$("#NAVIREnombreEquipagesSurpol").val($(`#${e} :nth-child(9)`)[0].innerText),$("#NAVIRETESurpol").val($(`#${e} :nth-child(10)`)[0].innerText)}function GETEventsSurpol(e=!0){const t=new XMLHttpRequest;t.onload=function(){debugUpdates&&console.log("GETEventsSurpol onload"),e||tableDestEventsSurpol.destroy(),tableDestEventsSurpol=$("#CHRONOtableShowSurpol").DataTable({language:{info:"Affichage de la page _PAGE_ sur _PAGES_",infoFiltered:"(filtrée de _MAX_ entrée)",lengthMenu:"Affichage de _MENU_ entrées",searchPlaceholder:"Chercher:  "},info:!0,autoFill:!0,rowReorder:{snapX:-5},columnDefs:[{orderable:!0,className:"reorder",targets:0},{orderable:!1,targets:"_all"}]})},t.open("GET","n"),t.send()}function deleteTestSurpolEvent(e){e.stopPropagation();e=$(this).data("eventid");$("#delete-Surpol-Event-"+e).addClass("hidden"),$("#cancel-Surpol-Event-"+e).removeClass("hidden"),$("#confirm-Surpol-Event-"+e).removeClass("hidden")}function cancelTestSurpolEvent(e){e.stopPropagation();e=$(this).data("eventid");$("#delete-Surpol-Event-"+e).removeClass("hidden"),$("#cancel-Surpol-Event-"+e).addClass("hidden"),$("#confirm-Surpol-Event-"+e).addClass("hidden")}function confirmTestSurpolEvent(e){e.stopPropagation();e=$(this).data("eventid");let t=$(".Surpol-Evant-row-"+e);t.remove(),tableDestEventsSurpol.row(t).remove()}function addListnerToDetectChangesInFormSurpol(){$("#formSurpol :input").change(function(){$("#formSurpol").data("changed",!0)})}function addListnerForEventTableSurpol(){let t=-1;$("#CHRONOaddButtonSurpol").off("click").on("click",function(e){t++,e.preventDefault(),$("#CHRONOdateSurpol")[0].reportValidity()&&$("#CHRONOheureUTCSurpol")[0].reportValidity()&&$("#CHRONOTphVHFSurpol")[0].reportValidity()&&""!=$("#CHRONOtextAreaSurpol")[0].value&&(myNotif("success","Event Added !",2e3),tableDestEventsSurpol.row.add($(`
        <tr class="Surpol-Evant-row-${t} active-row ${t%2?"even":"odd"}">
        <td class="movRow" style="width:40px"> ${Math.floor($("#CHRONOtableShowSurpol tbody tr :not(:has(>td[class=dataTables_empty]))").length/14)}</td>
          <td contenteditable="true" style="width:90px">${$("#CHRONOdateSurpol").val()}</td>
          <td contenteditable="true" style="width:90px">${$("#CHRONOheureUTCSurpol").val()}</td>
          <td contenteditable="true" style="width:70px">${$("#CHRONOTphVHFSurpol").val()}</td>
          <td contenteditable="true"><pre>${$("#CHRONOtextAreaSurpol").val()}</pre></td>

          <td style="width:80px" class="controleTd">
            <span class="btnControl btnControlDelete" data-eventid="${t}" id="delete-Surpol-Event-${t}"><i class="icon-TRASH "></i></span>
            <span class="btnControl btnControlCancel hidden"  data-eventid="${t}" id="cancel-Surpol-Event-${t}"><i class="icon-CLOSE "></i></span>
            <span class="btnControl btnControlConfirm hidden" data-eventid="${t}" id="confirm-Surpol-Event-${t}"><i class="icon-CHECK "></i></span>
          </td>

          <script>
          $('#delete-Surpol-Event-${t}').off('click').on('click', deleteTestSurpolEvent); $('#cancel-Surpol-Event-${t}').on('click', cancelTestSurpolEvent);
          $('#confirm-Surpol-Event-${t}').off('click').on('click', confirmTestSurpolEvent);
          </script>
        <tr>
    `)).draw(),$("#CHRONOtextAreaSurpol")[0].value=""),$("#CHRONOtextAreaSurpol")[0].focus()})}function addListnerForStringSelectToTextAreaSurpol(){$("#CHRONOaddActionSurpol").off("change").on("change",function(){$("#CHRONOtextAreaSurpol")[0].value+=$(this).val()+" ",$("#CHRONOaddActionSurpol")[0].selectedIndex=0,$("#CHRONOtextAreaSurpol")[0].focus()})}function showHideSurpol(){var t=document.querySelectorAll(".FormGrpSurpol .childFormGrp");let o=document.querySelectorAll(".FormGrpSurpol > .title");for(let e=0;e<t.length;e++)o[e].addEventListener("click",()=>{$($(".FormGrpSurpol .childFormGrp")[e]).toggle("slow")})}function configTypeEventSurpol(){switch($("#idEvent")[0].innerHTML="( "+$("select[name=IEQevenement]")[0].value+" )",$("select[name=IEQevenement]")[0].value){case"EN COURS":$("#idEvent").css("color","red");break;case"CLOSE":$("#idEvent").css("color","orange");break;case"ARCHIVÉ":$("#idEvent").css("color","green")}}function resetSurpolFormTop(){$("#resetSurpolFormTop").off("click").on("click",function(){myNotif("success","Surpol Form Reset !",2e3),$("#formSurpol")[0].reset(),$("#formSurpol").data("changed",!1),tableDestEventsSurpol.rows().remove().draw(),FintervalGlobalLastIdSurpol(),GetLastIdSurpol(),setTimeout(()=>{setThisDateSurpol(),GETNavireSurpol(!1),configTypeEventSurpol()},100)})}function gotoMapSurpol(){$("#gotoGoogleMaps1Surpol").off("click").on("click",function(){if($("#TOLpositionN1Surpol")[0].reportValidity()&&$("#TOLpositionE1Surpol")[0].reportValidity()){let e=$("#TOLpositionN1Surpol")[0].value.replace(",","'"),t=$("#TOLpositionE1Surpol")[0].value.replace(",","'");e=(e=(e=(e=(e=e.slice(0,-1)).replace(/\s/g,"")).replace("°"," ")).replace("'",".")).replace(",","."),t=(t=(t=(t=(t=t.slice(0,-1)).replace(/\s/g,"")).replace("°"," ")).replace("'",".")).replace(",",".");var o=`https://www.google.com/maps/place/${e}+`+t;window.open(o,"_blank")}}),$("#gotoGoogleMaps2Surpol").off("click").on("click",function(){if($("#TOLpositionN2Surpol")[0].reportValidity()&&$("#TOLpositionE2Surpol")[0].reportValidity()){let e=$("#TOLpositionN2Surpol")[0].value.replace(",","'"),t=$("#TOLpositionE2Surpol")[0].value.replace(",","'");e=(e=(e=(e=(e=e.slice(0,-1)).replace(/\s/g,"")).replace("°"," ")).replace("'",".")).replace(",","."),t=(t=(t=(t=(t=t.slice(0,-1)).replace(/\s/g,"")).replace("°"," ")).replace("'",".")).replace(",",".");var o=`https://www.google.com/maps/place/${e}+`+t;window.open(o,"_blank")}})}function UpdateSurpolForm(){window.sessionStorage.updateSurpolFormID&&$.ajax({type:"GET",dataType:"text",url:"views/Php/Surpol/SurpolGetByIdToUpdate.php?ID="+window.sessionStorage.updateSurpolFormID,success:function(e){let t=e.split("!;!")[0].split(",;,"),o=e.split("!;!")[1].split(":;:");t.shift();for(let e=0;e<=15;e++)$("#formSurpol")[0].elements[e].value=t[e];""!=t[16]&&$("#formSurpol input[name=classification]input[value="+t[16]+"]").click(),""!=t[17]&&$("#formSurpol input[name=connecte]input[value="+t[17]+"]").click();for(let e=20;e<=75;e++)$("#formSurpol")[0].elements[e].value=t[e-2];for(let e=79;e<=106;e++)$("#formSurpol")[0].elements[e].value=t[e-5];for(let e=117;e<=120;e++)$("#formSurpol")[0].elements[e].value=t[e-15];o.map((e,t)=>{""!=e&&tableDestEventsSurpol.row.add($(`
                <tr class="Surpol-Evant-row-${t} active-row ${t%2?"even":"odd"}">
                <td class="movRow" style="width:40px"> ${t} </td>
                  <td contenteditable="true" style="width:90px"> ${e.split(",;,")[0]} </td>
                  <td contenteditable="true" style="width:90px"> ${e.split(",;,")[1]} </td>
                  <td contenteditable="true" style="width:70px"> ${e.split(",;,")[2]} </td>
                  <td contenteditable="true" > ${e.split(",;,")[3]} </td>
          
                  <td style="width:80px" class="controleTd">
                    <span class="btnControl btnControlDelete" data-eventid="${t}" id="delete-Surpol-Event-${t}"><i class="icon-TRASH "></i></span>
                    <span class="btnControl btnControlCancel hidden"  data-eventid="${t}" id="cancel-Surpol-Event-${t}"><i class="icon-CLOSE "></i></span>
                    <span class="btnControl btnControlConfirm hidden" data-eventid="${t}" id="confirm-Surpol-Event-${t}"><i class="icon-CHECK "></i></span>
                  </td>
          
                  <script>
                  $('#delete-Surpol-Event-${t}').off('click').on('click', deleteTestSurpolEvent); 
                  $('#cancel-Surpol-Event-${t}').off('click').on('click', cancelTestSurpolEvent);
                  $('#confirm-Surpol-Event-${t}').off('click').on('click', confirmTestSurpolEvent);
                  </script>
                <tr>
              `)).draw()}),clearInterval(intervalGlobalLastIdSurpol),$("#idSurpol")[0].setAttribute("trueId",window.sessionStorage.updateSurpolFormID),$("#idSurpol")[0].innerHTML=window.sessionStorage.updateSurpolForm,window.sessionStorage.removeItem("updateSurpolFormID"),window.sessionStorage.removeItem("updateSurpolForm")}})}$(document).on("submit","#formSurpol",function(e){e.preventDefault();var e=$("#idSurpol")[0].getAttribute("trueid"),t=$("#idSurpol")[0].innerHTML.split(" ")[0];let o=$("#idSurpol")[0].innerHTML.split(" ")[1];const l=new XMLHttpRequest;l.onload=function(){"success"==this.responseText?("Update"!=o&&GetLastIdSurpol(),myNotif("success","Surpol Form Success ("+$("#idSurpol")[0].innerHTML.split(" ")[0]+") !",2e3),$("#ResetFormsSurpol")[0].checked&&($("#formSurpol")[0].reset(),$("#formSurpol").data("changed",!1),tableDestEventsSurpol.rows().remove().draw(),FintervalGlobalLastIdSurpol(),GetLastIdSurpol()),setTimeout(()=>{setThisDateSurpol(),GETNavireSurpol(!1)},100)):myNotif("error","Surpol Form Error !\n"+this.responseText.split("::")[1],2e3)},tableDestEventsSurpol.column("0:visible").order("asc").draw(),tableDestEventsSurpol.rows().invalidate().draw();let r=tableDestEventsSurpol.rows().data().map(function(e){return e.slice()});r=r.map(e=>(e.shift(),e.pop(),e.join("!,;"))),debug&&(console.log(r.join("        ")),console.log(`views/Php/Surpol/SurpolSetData.php?i=${e}&id=${t}&update=${o}&${$(this).serialize()}&events=${r.join("!;!")}
    &updateNavire=`+$("#NAVIREUpdateSurpol")[0].checked)),l.open("GET",`views/Php/Surpol/SurpolSetData.php?i=${e}&id=${t}&update=${o}&${$(this).serialize()}&events=${encodeURIComponent(r.join("!;!"))}&updateNavire=`+$("#NAVIREUpdateSurpol")[0].checked),l.send()});