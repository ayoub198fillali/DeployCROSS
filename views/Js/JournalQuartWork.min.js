let tableDestEventsJQ,ActionJQ,SarADQJQ,SarCDQJQ,SurnavJQ,SarJQ,TelecJQ,ChefDeQuartJQ,officierDeTechnicienJQ,officierDeRenfortJQ,officierDeGardeJQ,officierDePermananceJQ;function ConfigUpdateAllListsJQ(){$.ajax({type:"GET",dataType:"text",url:"views/Php/JournalQuart/GETAllLists.php",success:function(e){let t=e.split(";!;");officierDePermananceJQ=t[0].split(","),officierDeGardeJQ=t[1].split(","),officierDeRenfortJQ=officierDePermananceJQ,officierDeTechnicienJQ=t[2].split(","),ChefDeQuartJQ=officierDeGardeJQ,TelecJQ=t[3].split(","),SarJQ=TelecJQ,SurnavJQ=TelecJQ,SarCDQJQ=ChefDeQuartJQ,SarADQJQ=TelecJQ,ActionJQ=t[4].split(",")}})}function AllConfigInputJQ(){ConfigOfficierDePermananceJQ(),ConfigOfficierDeGardeJQ(),ConfigOfficierDeRenfortJQ(),ConfigTechnicienJQ(),ConfigCDQJQ(),ConfigTelecJQ(),ConfigSARJQ(),ConfigSurnavJQ(),ConfigSAR2CDQJQ(),ConfigSAR2ADQJQ(),ConfigActionsJQ()}function ConfigOfficierDePermananceJQ(){let t;$("#officierDePermananceJQ").each(function(){t="";for(const e of officierDePermananceJQ)t+=`<option>${e}</option>`;$(this).empty().append(t),sortSelect($(this)[0].id)})}function ConfigOfficierDeGardeJQ(){let t;$("#officierDeGardeJQ").each(function(){t="";for(const e of officierDeGardeJQ)t+=`<option>${e}</option>`;$(this).empty().append(t),sortSelect($(this)[0].id)})}function ConfigOfficierDeRenfortJQ(){let t;$("#officierDeRenfortJQ").each(function(){t="";for(const e of officierDeRenfortJQ)t+=`<option>${e}</option>`;$(this).empty().append(t),sortSelect($(this)[0].id)})}function ConfigTechnicienJQ(){let t;$("#officierDeTechnicienJQ").each(function(){t="";for(const e of officierDeTechnicienJQ)t+=`<option>${e}</option>`;$(this).empty().append(t),sortSelect($(this)[0].id)})}function ConfigCDQJQ(){let t;$(".CDQclassJQ").each(function(){t="";for(const e of ChefDeQuartJQ)t+=`<option>${e}</option>`;$(this).empty().append(t),sortSelect($(this)[0].id)})}function ConfigTelecJQ(){let t;$(".TRANSclassJQ").each(function(){t="";for(const e of TelecJQ)t+=`<option>${e}</option>`;$(this).empty().append(t),sortSelect($(this)[0].id)})}function ConfigSARJQ(){let t;$(".SARclassJQ").each(function(){t="";for(const e of SarJQ)t+=`<option>${e}</option>`;$(this).empty().append(t),sortSelect($(this)[0].id)})}function ConfigSurnavJQ(){let t;$(".RenfortclassJQ").each(function(){t="";for(const e of SurnavJQ)t+=`<option>${e}</option>`;$(this).empty().append(t),sortSelect($(this)[0].id)})}function ConfigSAR2CDQJQ(){let t;$(".SAR2CDQclassJQ").each(function(){t="";for(const e of SarCDQJQ)t+=`<option>${e}</option>`;$(this).empty().append(t),sortSelect($(this)[0].id)})}function ConfigSAR2ADQJQ(){let t;$(".SAR2ADQclassJQ").each(function(){t="";for(const e of SarADQJQ)t+=`<option>${e}</option>`;$(this).empty().append(t),sortSelect($(this)[0].id)})}function ConfigActionsJQ(){let e;for(const t of ActionJQ)e+=`<option>${t}</option>`;$("#addActionJQ").empty().append(e),sortSelect("addActionJQ")}function ConfigJQ(e=!1){debug&&console.log("*** ConfigJQ =>"+e),e?AllConfigInputJQ():Swal.fire({title:"Update Data From Server !",html:"A Few Milliseconds Please.",timer:1e3,timerProgressBar:!0,didOpen:()=>{Swal.showLoading()}}).then(()=>{AllConfigInputJQ()}),setTimeout(()=>{0==$("#officierDePermananceJQ option").length?ConfigJQ(!0):UpdateJQForm($("#mainDateJQ").val())},500)}function SetPropsJQ(){$("#mainDateJQ").off("change").on("change",function(){UpdateJQForm($(this).val())}),showHideJQ(),setThisMainDateJQ(),setThisDateEventJQUpdate(),addListnerForStringSelectToTextAreaJQ(),GETEventsJQ(),addListnerForEventTableJQ(),addListnerToDetectChangesInFormJQ(),ConfigUpdateAllListsJQ(),setTimeout(()=>{ConfigJQ()},100)}function setThisMainDateJQ(){$("#mainDateJQ").val((new Date).toISOString().split("T")[0])}function setThisDateEventJQUpdate(){let e=(new Date).toISOString().split("T");$("#quartDeJQ")[0].selectedIndex=parseInt(e[1].split(".")[0].split(":",1))/4,$("#dateJQ").val(e[0]),$("#aJQ").val(e[1].split(".")[0].split(":",2).join(":"));const t=e[1].split(".")[0].split(":",2).join("."),n=$("#progressJQ")[0];let o=(100*(t.split(".")[0]+"."+parseInt(100*t.split(".")[1]/60))/24).toFixed(2);$("#mainDateJQ").val()<e[0]?o=100:$("#mainDateJQ").val()>e[0]&&(o=0),setTimeout(()=>{n.style.width=(o<100?o:100)+"%",70<o&&o<=100?n.style.backgroundColor="red":40<o&&o<=70?n.style.backgroundColor="orange":o<=40?n.style.backgroundColor="green":n.style.backgroundColor="black"},200)}function GETEventsJQ(e=!0){const t=new XMLHttpRequest;t.onload=function(){debugUpdates&&console.log("GETEventsJQ onload"),e||tableDestEventsJQ.destroy(),tableDestEventsJQ=$("#CHRONOtableShowJQ").DataTable({language:{info:"Affichage de la page _PAGE_ sur _PAGES_",infoFiltered:"(filtrée de _MAX_ entrée)",lengthMenu:"Affichage de _MENU_ entrées",searchPlaceholder:"Chercher:  "},info:!0,autoFill:!0,rowGroup:{dataSrc:1},columnDefs:[{orderable:!0,className:"reorder",targets:0},{orderable:!1,targets:"_all"}],rowReorder:{snapX:-5}})},t.open("GET","n"),t.send()}function deleteTestJQEvent(e){e.stopPropagation();e=$(this).data("eventid");$("#delete-JQ-Event-"+e).addClass("hidden"),$("#cancel-JQ-Event-"+e).removeClass("hidden"),$("#confirm-JQ-Event-"+e).removeClass("hidden")}function cancelTestJQEvent(e){e.stopPropagation();e=$(this).data("eventid");$("#delete-JQ-Event-"+e).removeClass("hidden"),$("#cancel-JQ-Event-"+e).addClass("hidden"),$("#confirm-JQ-Event-"+e).addClass("hidden")}function confirmTestJQEvent(e){e.stopPropagation();e=$(this).data("eventid");let t=$(".JQ-Evant-row-"+e);t.remove(),tableDestEventsJQ.row(t).remove()}function showHideJQ(){var t=document.querySelectorAll(".FormGrpSurnav .childFormGrp");let n=document.querySelectorAll(".FormGrpSurnav > .title");for(let e=0;e<t.length;e++)n[e].addEventListener("click",()=>{$($(".FormGrpSurnav .childFormGrp")[e]).toggle("slow")})}function addListnerToDetectChangesInFormJQ(){$("#formJQ :input").change(function(){$("#formJQ").data("changed",!0),$("#StatusJQ").css("background-color","red"),setThisDateEventJQUpdate()})}function addListnerForEventTableJQ(){let t=-1;$("#addButtonJQ").off("click").on("click",function(e){t++,e.preventDefault(),$("#quartDeJQ")[0].reportValidity()&&$("#dateJQ")[0].reportValidity()&&$("#aJQ")[0].reportValidity()&&""!=$("#textAreaJQ")[0].value&&(myNotif("success","Event Added !",2e3),tableDestEventsJQ.row.add($(`
          <tr class="JQ-Evant-row-${t} active-row ${t%2?"even":"odd"}">
          <td class="movRow" style="width:40px">${Math.floor($("#CHRONOtableShowJQ tbody tr :not(:has(>td[class=dataTables_empty]))").length/14)}</td>
            <td contenteditable="true" style="width:90px">${$("#quartDeJQ").val()}</td>
            <td contenteditable="true" style="width:90px">${$("#dateJQ").val()}</td>
            <td contenteditable="true" style="width:90px">${$("#aJQ").val()}</td>
            <td contenteditable="true"><pre>${$("#textAreaJQ").val()}</pre></td>
  
            <td style="width:80px" class="controleTd">
              <span class="btnControl btnControlDelete" data-eventid="${t}" id="delete-JQ-Event-${t}"><i class="icon-TRASH "></i></span>
              <span class="btnControl btnControlCancel hidden"  data-eventid="${t}" id="cancel-JQ-Event-${t}"><i class="icon-CLOSE "></i></span>
              <span class="btnControl btnControlConfirm hidden" data-eventid="${t}" id="confirm-JQ-Event-${t}"><i class="icon-CHECK "></i></span>
            </td>
  
            <script>
            $('#delete-JQ-Event-${t}').off('click').on('click', deleteTestJQEvent); $('#cancel-JQ-Event-${t}').on('click', cancelTestJQEvent);
            $('#confirm-JQ-Event-${t}').off('click').on('click', confirmTestJQEvent);
            </script>
          <tr>
      `)).draw(),$("#textAreaJQ")[0].value=""),$("#textAreaJQ")[0].focus()})}function addListnerForStringSelectToTextAreaJQ(){$("#addActionJQ").off("change").on("change",function(){$("#textAreaJQ")[0].value+=$(this).val()+" ",$("#addActionJQ")[0].selectedIndex=0,$("#textAreaJQ")[0].focus()})}function UpdateJQForm(e=(new Date).toISOString().split("T")[0]){$("#StatusJQ").css("background-color","green"),$.ajax({type:"GET",dataType:"text",url:"views/Php/JournalQuart/JQGetByIdToUpdate.php?date="+e,success:function(e){tableDestEventsJQ.clear().draw();let t,n;n=""!=e.trim()?(t=e.split("!;!")[0].split(",;,"),e.split("!;!")[1].split(":;:")):(t=",,,,,!*!,,,,,!*!,,,,,!*!,,,,,!*!,,,,,!*!,,,,,",""),$("#formJQ")[0].elements[1].value=t[1],$("#formJQ")[0].elements[2].value=t[2],$("#formJQ")[0].elements[3].value=t[3],$("#formJQ")[0].elements[4].value=t[4],$(".CDQclassJQ").each(function(e){$(this).val(t[5].split(",")[e])}),$(".TRANSclassJQ").each(function(e){$(this).val(t[6].split(",")[e])}),$(".SARclassJQ").each(function(e){$(this).val(t[7].split(",")[e])}),$(".RenfortclassJQ").each(function(e){$(this).val(t[8].split(",")[e])}),$(".SAR2CDQclassJQ").each(function(e){$(this).val(t[9].split(",")[e])}),$(".SAR2ADQclassJQ").each(function(e){$(this).val(t[10].split(",")[e])}),""!=n&&n.map((e,t)=>{""!=e&&tableDestEventsJQ.row.add($(`
              <tr class="JQ-Evant-row-${t} active-row ${t%2?"even":"odd"}">
              <td class="movRow" style="width:40px"> ${Math.floor($("#CHRONOtableShowJQ tbody tr :not(:has(>td[class=dataTables_empty]))").length/14)} </td>
                <td contenteditable="true" style="width:90px">${e.split(",;,")[0]}</td>
                <td contenteditable="true" style="width:90px">${e.split(",;,")[1]}</td>
                <td contenteditable="true" style="width:90px">${e.split(",;,")[2]}</td>
                <td contenteditable="true"><pre>${e.split(",;,")[3]}</pre></td>
      
                <td style="width:80px" class="controleTd">
                  <span class="btnControl btnControlDelete" data-eventid="${t}" id="delete-JQ-Event-${t}"><i class="icon-TRASH "></i></span>
                  <span class="btnControl btnControlCancel hidden"  data-eventid="${t}" id="cancel-JQ-Event-${t}"><i class="icon-CLOSE "></i></span>
                  <span class="btnControl btnControlConfirm hidden" data-eventid="${t}" id="confirm-JQ-Event-${t}"><i class="icon-CHECK "></i></span>
                </td>
      
                <script>
                $('#delete-JQ-Event-${t}').off('click').on('click', deleteTestJQEvent); $('#cancel-JQ-Event-${t}').on('click', cancelTestJQEvent);
                $('#confirm-JQ-Event-${t}').off('click').on('click', confirmTestJQEvent);
                </script>
              <tr>
          `)).draw()})}}),setTimeout(()=>{$("#StatusJQ").css("background-color","green")},200)}$(document).on("submit","#formJQ",function(e){e.preventDefault();let t=$("#mainDateJQ").val();var e=$("#officierDePermananceJQ").val(),n=$("#officierDeRenfortJQ").val(),o=$("#officierDeGardeJQ").val(),i=$("#officierDeTechnicienJQ").val();let a="",s="",c="",l="",r="",d="";$(".CDQclassJQ").each(function(){a=a+$(this).val()+","}),$(".TRANSclassJQ").each(function(){s=s+$(this).val()+","}),$(".SARclassJQ").each(function(){c=c+$(this).val()+","}),$(".RenfortclassJQ").each(function(){l=l+$(this).val()+","}),$(".SAR2CDQclassJQ").each(function(){r=r+$(this).val()+","}),$(".SAR2ADQclassJQ").each(function(){d=d+$(this).val()+","});e=e+"!*!"+n+"!*!"+o+"!*!"+i+"!*!"+a.slice(0,-1)+"!*!"+s.slice(0,-1)+"!*!"+c.slice(0,-1)+"!*!"+l.slice(0,-1)+"!*!"+r.slice(0,-1)+"!*!"+d.slice(0,-1);const f=new XMLHttpRequest;f.onload=function(){"success"==this.responseText?($("#StatusJQ").css("background-color","green"),myNotif("success","JQ Form Success ("+t+") !",2e3)):myNotif("error","JQ Form Error !",2e3)},tableDestEventsJQ.column("0:visible").order("asc").draw(),tableDestEventsJQ.rows().invalidate().draw();let Q=tableDestEventsJQ.rows().data().map(function(e){return e.slice()});Q=Q.map(e=>(e.shift(),e.pop(),e.join("!,;"))),debug&&console.log(Q.join(" !! ")),debug&&console.log(`views/Php/JournalQuart/JQSetData.php?date=${t}&dataGlobal=${e}&events=`+encodeURIComponent(Q.join("!;!"))),f.open("GET",`views/Php/JournalQuart/JQSetData.php?date=${t}&dataGlobal=${e}&events=`+encodeURIComponent(Q.join("!;!"))),f.send()});